/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={"./src/FuzzySearch.ts":(t,e,s)=>{s.r(e),s.d(e,{default:()=>FuzzySearch}),Application.prototype._recalculateDimensions=function(){this.element[0].style.height="",this.setPosition({})};class SettingsProcessor{_updateLabels(t,e,s){const[i,n]=t.split(SettingsProcessor.DELIM);if(void 0!==s){isNaN(s)&&(s=0);const[t,i]=s<=.5?[s/.5,1]:[1,1-(s-.5)/.5],n=Math.round(255*t).toString(16).padStart(2,"0"),r=Math.round(255*i).toString(16).padStart(2,"0");e.css("border-left",`thick solid #${n}${r}00`),e.css("padding-left","6px")}else e.css("border-left",""),e.css("padding-left","");e.find(">label").html(i),e[0].classList.contains("submenu")?e.find("button>label").html(n):e.find(".notes").html(n)}_getOptions(t){return{keys:["text"],limit:1/0,threshold:-Math.min(1e5,1e4+1e4*t.length),allowTypo:!1}}}SettingsProcessor.DELIM=" `````` ";class DefaultSettingsProcessor extends SettingsProcessor{constructor(){super(...arguments),this._settings=[]}_getMenuData(t){return{el:t,text:$(t).find(">label").text()+SettingsProcessor.DELIM+$(t).find("button").find("label").text()+SettingsProcessor.DELIM+$(t).find(".notes").text()}}_getRegularData(t){return{el:t,text:$(t).find(">label").text()+SettingsProcessor.DELIM+$(t).find(".notes").text()}}processSettings(t){t.find(".categories > .scrollable").children().each(((t,e)=>{$(e).children().each(((t,e)=>{e instanceof HTMLHeadingElement||(e.classList.contains("submenu")?this._settings.push(this._getMenuData($(e))):this._settings.push(this._getRegularData($(e))))}))}))}injectSearch(t){return t.find('input[name="filter"]')}performSearch(t){if(t.length<2){for(const t of this._settings)t.el.show(),this._updateLabels(t.text,t.el);return}const e=fuzzysort.go(t,this._settings,this._getOptions(t));for(let t=0;t<this._settings.length;t++){const s=e.findIndex((e=>e.obj===this._settings[t]));let i,n;s>=0?(this._settings[t].el.show(),i=fuzzysort.highlight(e[s][0]),n=s/(e.length-1)):(this._settings[t].el.hide(),i=this._settings[t].text),this._updateLabels(i,this._settings[t].el,n)}}}class FuzzySearch{static init(){Hooks.on("renderSettingsConfig",((t,e,s)=>{this._settingsProcessor=new DefaultSettingsProcessor,this._settingsProcessor.processSettings(e);this._settingsProcessor.injectSearch(e).on("input",(function(){FuzzySearch._settingsProcessor.performSearch($(this).val())})),t._recalculateDimensions()}))}}FuzzySearch._settingsProcessor=null}},e={};function __webpack_require__(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(t,e)=>{for(var s in e)__webpack_require__.o(e,s)&&!__webpack_require__.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};(()=>{__webpack_require__.r(s);var t=__webpack_require__("./src/FuzzySearch.ts");class DFSettingsClarity{static patchGameSettings(){var t;libWrapper.register("df-settings-clarity","ClientSettings.prototype.register",DFSettingsClarity.settingsRegister,"WRAPPER");for(const e of game.settings.settings)e[1].name=DFSettingsClarity.formatName(null!==(t=e[1].name)&&void 0!==t?t:"",e[1])}static patchGameSettingsMenus(){var t;libWrapper.register("df-settings-clarity","ClientSettings.prototype.registerMenu",DFSettingsClarity.settingsRegisterMenu,"WRAPPER");for(const e of game.settings.menus)e[1].name=DFSettingsClarity.formatName(null!==(t=e[1].name)&&void 0!==t?t:"",e[1])}static formatName(t,e){if(t.startsWith("ðŸ‘¤")||t.startsWith("ðŸŒŽ"))return t;let s;return e.scope?s=DFSettingsClarity.types.includes(e.scope)?e.scope:"client":e.restricted?s=e?"world":"client":(console.warn("Unknown restriction/scope on registered setting for "+t+'". Defaulting to "client"'),s="client"),"client"===s?t?"ðŸ‘¤ "+game.i18n.localize(t):"ðŸ‘¤":"world"===s?t?"ðŸŒŽ "+game.i18n.localize(t):"ðŸŒŽ":t}static settingsRegister(t,e,s,i){var n;i.name=DFSettingsClarity.formatName(null!==(n=i.name)&&void 0!==n?n:"",i),t(e,s,i)}static settingsRegisterMenu(t,e,s,i){var n;i.name=DFSettingsClarity.formatName(null!==(n=i.name)&&void 0!==n?n:"",i),t(e,s,i)}static showWorldHover(t){t.clientX>$(t.target).offset().left+30?DFSettingsClarity.hideHover():DFSettingsClarity.showHover($(t.target),"world")}static showClientHover(t){t.clientX>$(t.target).offset().left+30?DFSettingsClarity.hideHover():DFSettingsClarity.showHover($(t.target),"client")}static showHover(t,e){const s=DFSettingsClarity.hover;if(0!=s.parent().length)return;s.find("span.msg").text(game.i18n.localize("DF_SETTINGS_CLARITY.Scope_"+e)),$(document.body).append(s);const i={position:"absolute",left:t.offset().left-s.outerWidth()+"px",top:t.offset().top-15+"px"};s.css(i)}static hideHover(){0!=DFSettingsClarity.hover.parent().length&&DFSettingsClarity.hover.remove()}}DFSettingsClarity.types=["client","world"],DFSettingsClarity.hover=$('<div class="df-settings-clarity-tooltip" style="visibility:hidden"><span class="msg"></span><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtMCAwLjVhMTEuNDA4IDExLjQwOCAyNC4wNTcgMCAxIDcuNjUxNCAzLjQxNThsMTEuODQ5IDExLjA4NC0xMS44NDkgMTEuMDg0YTExLjQwOCAxMS40MDggMTU1Ljk0IDAgMS03LjY1MTQgMy40MTU4IiBmaWxsPSIjMDAwMDAwQmYiIHN0cm9rZT0iI2Y2MCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjwvc3ZnPg=="></div>'),Hooks.once("init",(function(){t.default.init()})),Hooks.once("setup",(function(){const t=game.data.users.find((t=>t._id===game.userId)),e=game.settings.get("core","permissions");t&&e.SETTINGS_MODIFY.includes(t.role)&&(DFSettingsClarity.patchGameSettings(),DFSettingsClarity.patchGameSettingsMenus()),$(document.body).append(DFSettingsClarity.hover)})),Hooks.once("ready",(function(){var t;if(!(null===(t=game.modules.get("lib-wrapper"))||void 0===t?void 0:t.active))return console.error("Missing libWrapper module dependency"),void(game.user.isGM&&ui.notifications.error(game.i18n.localize("DF_SETTINGS_CLARITY.errorLibWrapperMissing")));DFSettingsClarity.hover.remove(),DFSettingsClarity.hover.attr("style","")})),Hooks.on("renderSettingsConfig",(function(t,e,s){const i=e.find("label:contains('ðŸŒŽ')");i.on("mousemove",DFSettingsClarity.showWorldHover),i.on("mouseleave",DFSettingsClarity.hideHover);const n=e.find("label:contains('ðŸ‘¤')");n.on("mousemove",DFSettingsClarity.showClientHover),n.on("mouseleave",DFSettingsClarity.hideHover)}))})()})();
//# sourceMappingURL=main.js.map